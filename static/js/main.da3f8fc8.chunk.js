(this["webpackJsonpexcel-viewer"]=this["webpackJsonpexcel-viewer"]||[]).push([[0],{40:function(e,a,n){},42:function(e,a){},52:function(e,a,n){e.exports=n(68)},57:function(e,a,n){},63:function(e,a){},64:function(e,a){},68:function(e,a,n){"use strict";n.r(a);var t=n(0),r=n.n(t),l=n(8),o=n.n(l),i=(n(57),n(37)),c=n(13),s=(n(40),n(36)),u=n.n(s),m=n(101),g=n(104),d=n(106),p=n(107),f=n(108),h=n(109),E=n(110),b=n(116),v=n(111),y=n(115),w=Object(m.a)({table:{minWidth:700},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}});var A=function(e){var a,n=e.order,t=e.orderBy,l=e.columns,o=e.rows,i=e.page,c=e.rowsPerPage,s=e.handleRequestSort,u=e.handleChangeRowsPerPage,m=e.handleChangePage,A=w();return r.a.createElement("div",{className:"tableContainer"},r.a.createElement(g.a,{component:d.a},r.a.createElement(p.a,{className:A.table,"aria-label":"spanning table"},r.a.createElement(f.a,null,r.a.createElement(h.a,null,Array.isArray(l)&&l.map((function(e){return e.isEnableSorting?r.a.createElement(E.a,{sortDirection:t===e.name&&n,className:"tableColumn"},r.a.createElement(b.a,{active:t===e.name,direction:t===e.name?n:"asc",onClick:(a=e.name,function(e){s(e,a)})},e.displayName,t===e.name?r.a.createElement("span",{className:A.visuallyHidden},"desc"===n?"sorted descending":"sorted ascending"):null)):r.a.createElement(E.a,null,e.displayName);var a})))),r.a.createElement(v.a,null,Array.isArray(o)&&o.slice(i*c,i*c+c).map((function(e){return r.a.createElement(h.a,null,l.map((function(a){var n=a.name;return r.a.createElement(E.a,null,e[n])})))})),r.a.createElement(h.a,null,r.a.createElement(E.a,{rowSpan:4}),r.a.createElement(E.a,{colSpan:7,align:"right"},"Total amount"),r.a.createElement(E.a,null,(a=o.map((function(e){return e.Amount})).reduce((function(e,a){return e+a}),0),"".concat(a.toFixed(2)))))))),r.a.createElement(y.a,{rowsPerPageOptions:[10,25,100],component:"div",count:o.length,rowsPerPage:c,page:i,onChangePage:m,onChangeRowsPerPage:u}))},N=n(114),P=n(113),S=n(112),x=Object(m.a)((function(e){return{root:{},headerAlign:{width:"100%",height:"10%"},containerAlign:{display:"flex",justifyContent:"center",margin:"auto",flexDirection:"column",alignItems:"center",minHeight:"80%",paddingTop:"20px"},paper:{padding:e.spacing(2),textAlign:"center"},footerAlign:{width:"100%",bottom:"0px",position:"fixed"},footerAlignWithData:{width:"100%",position:"relative"}}}));var k=function(){var e=r.a.useState([]),a=Object(c.a)(e,2),n=a[0],t=a[1],l=r.a.useState(null),o=Object(c.a)(l,2),s=o[0],m=o[1],g=r.a.useState([]),p=Object(c.a)(g,2),f=p[0],h=p[1],E=r.a.useState("asc"),b=Object(c.a)(E,2),v=b[0],y=b[1],w=r.a.useState(""),k=Object(c.a)(w,2),j=k[0],O=k[1],C=r.a.useState(0),_=Object(c.a)(C,2),B=_[0],F=_[1],R=r.a.useState(10),T=Object(c.a)(R,2),D=T[0],M=T[1],W=r.a.useState(""),V=Object(c.a)(W,2),Y=(V[0],V[1]),H=function(e){var a=[],n=[];if(Array.isArray(e)&&e.length>0){var r=Object.keys(e[0]);e.forEach((function(a,t){if(t>0){var l={};r.forEach((function(r){if("Serial Number"===e[0][r]&&"NA"===a[r]){var o=n[n.length-1];if(o["Customer Name"]===a.__EMPTY_1)l[e[0][r]]=o["Serial Number"];else{var i=e[t+1];i.__EMPTY_1===a.__EMPTY_1&&(l[e[0][r]]=i.__EMPTY_2)}}else l[e[0][r]]=a[r]})),n.push(l)}}));var l=function(e){var a=[];return Object.keys(e).forEach((function(n,t){a.push({index:t,name:e[n],displayName:e[n],isEnableSorting:"Amount"===e[n]})})),a}(e[0]);t(l)}return Array.isArray(n)&&n.length>0&&n.forEach((function(e){var t,r;if(!a.find((function(a){return a["Serial Number"]===e["Serial Number"]}))){var l=(t=e,r="Serial Number",n.filter((function(e){return e[r]===t[r]})));if(Array.isArray(l)&&l.length>0){var o=l.reduce((function(e,a){return e+(a.Amount||0)}),0),c=l.reduce((function(e,a){return e+",".concat(a["Package Name"]||"")}),"").substring(1),s=l.findIndex((function(e){return"NA"!==e["VC Number"]&&"NA"!==e["Package Name"]&&"NA"!==e["Package Type"]}));a.push(Object(i.a)(Object(i.a)({},l[s]),{},{"S.NO":a.length+1,Amount:parseFloat(o.toFixed(2)),"Package Name":c}))}}})),console.log(n),console.log(a),a},I=x();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:I.root},r.a.createElement(P.a,{container:!0},r.a.createElement("header",{className:I.headerAlign},r.a.createElement(d.a,{component:"h1",className:I.paper},"Excel Viewer")),r.a.createElement(P.a,{item:!0,xs:12,className:I.containerAlign},r.a.createElement("input",{type:"file",id:"myFile",style:{color:"black",marginBottom:"15px"},name:"filename",onChange:function(e){!function(e){var a=e.target.files[0],n=a&&a.name?a.name:"",t=n.split(".").pop();n&&"xlsx"===t?(m(a),Y(n)):alert("Pls upload .xlsx file")}(e)},accept:".xlsx"}),s&&r.a.createElement(S.a,null,r.a.createElement(N.a,{color:"primary",variant:"contained",component:"label",style:{marginRight:"5px"},onClick:function(){return function(){var e=new FileReader,a=!!e.readAsBinaryString;console.log(),e.onload=function(e){var n=e.target.result,t=u.a.read(n,{type:a?"binary":"array",bookVBA:!0}),r=t.SheetNames[0],l=t.Sheets[r],o=u.a.utils.sheet_to_json(l),i=H(o);i.length>0?h(i):console.log("File is empty or sheet data is empty")},e.readAsBinaryString(s)}()}}," View"),r.a.createElement(N.a,{color:"primary",variant:"contained",component:"label",onClick:function(){m(null),Y(""),h([])}}," clear")),n&&f&&n.length>0&&f.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(A,{columns:n,rows:f,order:v,orderBy:j,page:B,rowsPerPage:D,handleChangePage:function(e,a){F(a)},handleChangeRowsPerPage:function(e){M(+e.target.value),F(0)},handleRequestSort:function(e,a){y(j===a&&"asc"===v?"desc":"asc"),O(a)}}))),r.a.createElement("footer",{className:n&&f&&n.length>0&&f.length>0?I.footerAlignWithData:I.footerAlign},r.a.createElement(S.a,{className:I.paper},r.a.createElement("span",null,"\ud83d\udcbb")," Design and developed by ",r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://www.linkedin.com/in/ponseelan/"},"Ponseelan"),r.a.createElement("span",null,"\ud83d\ude80"))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[52,1,2]]]);
//# sourceMappingURL=main.da3f8fc8.chunk.js.map